from flask import Flask, request
import os, json

app = Flask(__name__)
DATA_DIR = os.path.join(os.path.dirname(__file__), "public", "data")
os.makedirs(DATA_DIR, exist_ok=True)
FEEDBACK_PATH = os.path.join(DATA_DIR, "feedback.jsonl")

@app.post("/feedback")
def receive_feedback():
    data = request.get_json(force=True, silent=True) or {}
    with open(FEEDBACK_PATH, "a", encoding="utf-8") as f:
        f.write(json.dumps(data) + "\n")
    return {"status": "ok"}
